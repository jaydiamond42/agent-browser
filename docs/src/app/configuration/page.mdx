export const metadata = { title: "Configuration" }

# Configuration

Create an `agent-browser.json` file to set persistent defaults instead of repeating flags on every command.

## Config File Locations

agent-browser checks two locations, merged in priority order:

| Priority | Location | Scope |
|----------|----------|-------|
| 1 (lowest) | `~/.config/agent-browser.json` | User-level defaults |
| 2 | `./agent-browser.json` | Project-level overrides |
| 3 | `AGENT_BROWSER_*` env vars | Override config values |
| 4 (highest) | CLI flags | Override everything |

Project-level values override user-level values. Environment variables override both. CLI flags always win.

Use `--config <path>` to load a specific config file instead of the default locations:

```bash
agent-browser --config ./ci-config.json open example.com
```

## Example Config

```json
{
  "headed": true,
  "proxy": "http://localhost:8080",
  "profile": "./browser-data",
  "userAgent": "my-agent/1.0",
  "ignoreHttpsErrors": true
}
```

## All Options

Every CLI flag can be set in the config file using its camelCase equivalent:

| Config Key | CLI Flag | Type |
|------------|----------|------|
| `headed` | `--headed` | boolean |
| `json` | `--json` | boolean |
| `debug` | `--debug` | boolean |
| `session` | `--session` | string |
| `sessionName` | `--session-name` | string |
| `executablePath` | `--executable-path` | string |
| `extensions` | `--extension` | string[] |
| `profile` | `--profile` | string |
| `state` | `--state` | string |
| `proxy` | `--proxy` | string |
| `proxyBypass` | `--proxy-bypass` | string |
| `args` | `--args` | string |
| `userAgent` | `--user-agent` | string |
| `provider` | `-p, --provider` | string |
| `device` | `--device` | string |
| `ignoreHttpsErrors` | `--ignore-https-errors` | boolean |
| `allowFileAccess` | `--allow-file-access` | boolean |
| `cdp` | `--cdp` | string |
| `autoConnect` | `--auto-connect` | boolean |
| `headers` | `--headers` | string (JSON) |

## Common Configurations

### Local Development

```json
{
  "headed": true,
  "profile": "./browser-data"
}
```

### Behind a Proxy

```json
{
  "proxy": "http://proxy.corp.example.com:8080",
  "proxyBypass": "localhost,*.internal.com",
  "ignoreHttpsErrors": true
}
```

### CI / Devcontainer

```json
{
  "args": "--no-sandbox,--disable-gpu",
  "ignoreHttpsErrors": true
}
```

### iOS Testing

```json
{
  "provider": "ios",
  "device": "iPhone 16 Pro"
}
```

## Error Handling

- **Missing config files** are silently ignored.
- **Malformed JSON** prints a warning to stderr and continues without that file.
- **Unknown keys** are silently ignored for forward compatibility.
